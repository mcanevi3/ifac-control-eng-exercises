\edef\RLfilename{rlocus_data/\xone\xzero_p.txt}
\pgfplotstableread[col sep=space]{\RLfilename}\rootlocusdataPD

\pgfmathsetmacro{\pZero}{1+(2-1)*(10*\xone+\xzero)/99}
\pgfmathsetmacro{\pOne}{4+(5-4)*(10*\xone+\xzero)/99}
\pgfmathsetmacro{\zetaval}{0.5+(0.6-0.5)*(10*\xone+\xzero)/99}

\pgfmathsetmacro{\sigmad}{\pZero+\pOne}
\pgfmathsetmacro{\wn}{\sigmad/\zetaval}
\pgfmathsetmacro{\omegad}{\wn*sqrt(1-\zetaval^2)} 

\pgfmathsetmacro{\kVal}{2*\zetaval*\wn-\pOne-\pZero} 
\pgfmathsetmacro{\zVal}{(\wn*\wn-\pOne*\pZero)/\kVal} 

\pgfmathsetmacro{\angleZero}{atan2(\omegad, -\sigmad+\pZero)} 
\pgfmathsetmacro{\angleOne}{atan2(\omegad, -\sigmad+\pOne)} 
\pgfmathsetmacro{\anglezVal}{atan2(\omegad, -\sigmad+\zVal)}

\pgfmathsetmacro{\angleZeroComp}{180-\angleZero} 
\pgfmathsetmacro{\angleOneComp}{180-\angleOne} 
\pgfmathsetmacro{\anglezValComp}{180-\anglezVal} 

\question[30] A design point on the root-locus plot for a P-type controller is shown below. 
\begin{figure}[!htb]
  \centering
  \begin{tikzpicture}[start marker/.pic={\draw (-#1,-#1) -- (#1,#1) (#1,-#1)--(-#1,#1);}]
  \begin{axis}[
    no marks,line width=1.4pt,
    axis equal,
    grid=both,
    xlabel={$\Re$},
    ylabel={$\Im$},
    xmin=-12,xmax=1,ymin=-1,ymax=10,
    xticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=1,
      rotate=90,
      anchor=near xticklabel
    },
    yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=1
    },
    xtick={-\sigmad,-\pOne,-\pZero,0}, 
    ytick={0, \omegad},
    ]
  \draw[black,line width=0.4pt] (-20,0)--(20,0);
  \draw[black,line width=0.4pt] (0,-20)--(0,20);
  \foreach\x in{1,...,2}{
    \addplot+[
      restrict y to domain=-20:20,
      restrict x to domain=-20:20
    ] table[x=pr\x,y=pi\x] {\rootlocusdataPD} 
    node[draw,circle,inner sep=2pt] at (current plot end) {}
    pic at (current plot begin) {start marker=2pt};
  }
  \filldraw[black] (0,0) circle (3pt);
  \draw[black, dashed,line width=0.4pt] (0,0) -- (-2*\sigmad,2*\omegad);
  \draw[black, dashed,line width=0.4pt] (0,0) circle[radius=\wn];
  \filldraw[black] (-\sigmad,\omegad) circle (3pt);

  \node at (-2,2) {$\zeta=
  \pgfmathprintnumber[precision=3]{\zetaval}
  $};
  \node at (-9,4) {$w_n=
  \pgfmathprintnumber[precision=2]{\wn}
  $};
  \end{axis}
  \end{tikzpicture}
\end{figure}

A zero is added so that the root-locus passes through this design point. Which of the following represents the correct angle condition for this design?

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{randomizechoices}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\CorrectChoice \begin{minipage}{0.5\linewidth}
      \pgfmathsetmacro{\angleSum}{\angleZero+\angleOne-\anglezVal}
      \begin{equation*}
      \sum\theta=
      \pgfmathprintnumber[precision=1]{\angleZero}^\circ
      +\pgfmathprintnumber[precision=1]{\angleOne}^\circ
      -\pgfmathprintnumber[precision=1]{\anglezVal}^\circ
      = \ifprintanswers
      \pgfmathprintnumber[precision=1]{\angleSum}^\circ
       \fi 
      \end{equation*}
      \centering
      \begin{tikzpicture}
      \begin{axis}[
        no marks,line width=1.4pt,
        axis equal,
        grid=both,
        xlabel={$\Re$},
        ylabel={$\Im$},
        xmin=-20,xmax=0,ymin=-1,ymax=10,
        xticklabel style={
          /pgf/number format/fixed,
          /pgf/number format/precision=1,
          rotate=90,
          anchor=near xticklabel
      },
      yticklabel style={
          /pgf/number format/fixed,
          /pgf/number format/precision=1
      },
      xtick={-\zVal,-\sigmad,-\pOne,-\pZero,0}, 
      ytick={0, \omegad},
        ]
      \coordinate (origin) at (0,0);
      \coordinate (pZero) at (-\pZero,0);
      \coordinate (pOne) at (-\pOne,0);
      \coordinate (zPos) at (-\zVal,0);
      \coordinate (desired) at (-\sigmad,\omegad);
      \coordinate (leftPoint) at (-21,0);
      \coordinate (rightPoint) at (15,0);

      \draw[gray] (-20,0) -- (20,0);
      \draw[gray] (0,-20) -- (0,20);
      \filldraw[black] (origin) circle (3pt);
      \filldraw[red] (desired) circle (3pt);

      \draw[gray] (pZero) -- (desired);
      \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
      ]{angle = origin--pZero--desired};

      \draw[gray] (pOne) -- (desired);
      \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
      ]{angle = origin--pOne--desired};

      \draw[gray] (zPos) -- (desired);
      \pic[draw,thick, angle eccentricity=-4,angle radius=0.3cm 
      ]{angle = rightPoint--zPos--desired};


      \node[above] at ($(pZero) + (-20.5,-3)$) {$\pgfmathprintnumber[precision=1]{\angleZero}^\circ$};
      \node[above] at ($(pOne) + (-21,-3)$) {$\pgfmathprintnumber[precision=1]{\angleOne}^\circ$};
      \node[above] at ($(zPos) + (-19,-3)$) {$\pgfmathprintnumber[precision=1]{\anglezVal}^\circ$};

      \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pZero) {};
      \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pOne) {};
      \node[circle, draw=red, inner sep=0pt, minimum size=6pt] at (zPos) {};

      \end{axis}
      \end{tikzpicture}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\choice \begin{minipage}{0.5\linewidth}
  \pgfmathsetmacro{\angleSum}{\angleZero+\angleOne+\anglezValComp} %false1
  \begin{equation*}
  \sum\theta =
  \pgfmathprintnumber[precision=1]{\angleZero}^\circ
  +\pgfmathprintnumber[precision=1]{\angleOne}^\circ
  +\pgfmathprintnumber[precision=1]{\anglezValComp}^\circ
  =\ifprintanswers
  \pgfmathprintnumber[precision=1]{\angleSum}^\circ
  \fi
  \end{equation*}
  \centering
  \begin{tikzpicture}
  \begin{axis}[
    no marks,line width=1.4pt,
    axis equal,
    grid=both,
    xlabel={$\Re$},
    ylabel={$\Im$},
    xmin=-20,xmax=0,ymin=-1,ymax=10,
    xticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=1,
      rotate=90,
      anchor=near xticklabel
    },
    yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=1
   },
    xtick={-\zVal,-\sigmad,-\pOne,-\pZero,0}, 
    ytick={0, \omegad},
    ]
  \coordinate (origin) at (0,0);
  \coordinate (pZero) at (-\pZero,0);
  \coordinate (pOne) at (-\pOne,0);
  \coordinate (zPos) at (-\zVal,0);
  \coordinate (desired) at (-\sigmad,\omegad);
  \coordinate (leftPoint) at (-21,0);

  \draw[gray] (-20,0) -- (20,0);
  \draw[gray] (0,-20) -- (0,20);
  \filldraw[black] (origin) circle (3pt);
  \filldraw[red] (desired) circle (3pt);

  \draw[gray] (pZero) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pZero--desired};

  \draw[gray] (pOne) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pOne--desired};

  \draw[gray] (zPos) -- (desired);
  \pic[draw,thick, angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = desired--zPos--leftPoint};

  \node[above] at ($(pZero) + (-20.5,-3)$) {$\pgfmathprintnumber[precision=1]{\angleZero}^\circ$};
  \node[above] at ($(pOne) + (-21,-3)$) {$\pgfmathprintnumber[precision=1]{\angleOne}^\circ$};
  \node[above] at ($(zPos) + (-19,-3)$) {$\pgfmathprintnumber[precision=1]{\anglezValComp}^\circ$};

  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pZero) {};
  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pOne) {};
  \node[circle, draw=red, inner sep=0pt, minimum size=6pt] at (zPos) {};

  \end{axis}
  \end{tikzpicture}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\choice \begin{minipage}{0.5\linewidth}
  \pgfmathsetmacro{\angleSum}{\angleZeroComp+\angleOne+\anglezVal} %false2
  \begin{equation*}
  \sum\theta =
  \pgfmathprintnumber[precision=1]{\angleZeroComp}^\circ
  +\pgfmathprintnumber[precision=1]{\angleOne}^\circ
  +\pgfmathprintnumber[precision=1]{\anglezVal}^\circ
  =\ifprintanswers
  \pgfmathprintnumber[precision=1]{\angleSum}^\circ
  \fi
  \end{equation*}
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      no marks,line width=1.4pt,
      axis equal,
      grid=both,
      xlabel={$\Re$},
      ylabel={$\Im$},
      xmin=-20,xmax=0,ymin=-1,ymax=10,
      xticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=1,
        rotate=90,
        anchor=near xticklabel
    },
    yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=1
    },
      xtick={-\zVal,-\sigmad,-\pOne,-\pZero,0}, 
      ytick={0, \omegad},
    ]
  \coordinate (origin) at (0,0);
  \coordinate (pZero) at (-\pZero,0);
  \coordinate (pOne) at (-\pOne,0);
  \coordinate (zPos) at (-\zVal,0);
  \coordinate (desired) at (-\sigmad,\omegad);
  \coordinate (leftPoint) at (-21,0);
  \coordinate (rightPoint) at (15,0);

  \draw[gray] (-20,0) -- (20,0);
  \draw[gray] (0,-20) -- (0,20);
  \filldraw[black] (origin) circle (3pt);
  \filldraw[red] (desired) circle (3pt);

  \draw[gray] (pZero) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = desired--pZero--pOne}; %{angle = desired--pZero--pOne} {angle = pOne--pZero--desired}

  \draw[gray] (pOne) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pOne--desired};

  \draw[gray] (zPos) -- (desired);
  \pic[draw,thick, angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = rightPoint--zPos--desired};

  \node[above] at ($(pZero) + (-20.5,-3)$) {$\pgfmathprintnumber[precision=1]{\angleZeroComp}^\circ$};
  \node[above] at ($(pOne) + (-21,-3)$) {$\pgfmathprintnumber[precision=1]{\angleOne}^\circ$};
  \node[above] at ($(zPos) + (-19,-3)$) {$\pgfmathprintnumber[precision=1]{\anglezVal}^\circ$};

  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pZero) {};
  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pOne) {};
  \node[circle, draw=red, inner sep=0pt, minimum size=6pt] at (zPos) {};

  \end{axis}
  \end{tikzpicture}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\choice \begin{minipage}{0.5\linewidth}
  \pgfmathsetmacro{\angleSum}{\angleZero+\angleOneComp+\anglezVal} %false3
  \begin{equation*}
  \sum\theta=
  \pgfmathprintnumber[precision=1]{\angleZero}^\circ
  +\pgfmathprintnumber[precision=1]{\angleOneComp}^\circ
  +\pgfmathprintnumber[precision=1]{\anglezVal}^\circ
    =\ifprintanswers
    \pgfmathprintnumber[precision=1]{\angleSum}^\circ
  \fi
  \end{equation*}
  \centering
  \begin{tikzpicture}
  \begin{axis}[
    no marks,line width=1.4pt,
    axis equal,
    grid=both,
    xlabel={$\Re$},
    ylabel={$\Im$},
    xmin=-20,xmax=0,ymin=-1,ymax=10,
    xticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=1,
      rotate=90,
      anchor=near xticklabel
  },
  yticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=1
  },
      xtick={-\zVal,-\sigmad,-\pOne,-\pZero,0}, 
      ytick={0, \omegad},
    ]
  \coordinate (origin) at (0,0);
  \coordinate (pZero) at (-\pZero,0);
  \coordinate (pOne) at (-\pOne,0);
  \coordinate (zPos) at (-\zVal,0);
  \coordinate (desired) at (-\sigmad,\omegad);
  \coordinate (leftPoint) at (-21,0);
  \coordinate (rightPoint) at (15,0);

  \draw[gray] (-20,0) -- (20,0);
  \draw[gray] (0,-20) -- (0,20);
  \filldraw[black] (origin) circle (3pt);
  \filldraw[red] (desired) circle (3pt);

  \draw[gray] (pZero) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pZero--desired};

  \draw[gray] (pOne) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = desired--pOne--zPos};

  \draw[gray] (zPos) -- (desired);
  \pic[draw,thick, angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = rightPoint--zPos--desired};

  \node[above] at ($(pZero) + (-20.5,-3)$) {$\pgfmathprintnumber[precision=1]{\angleZero}^\circ$};
  \node[above] at ($(pOne) + (-21,-3)$) {$\pgfmathprintnumber[precision=1]{\angleOneComp}^\circ$};
  \node[above] at ($(zPos) + (-19,-3)$) {$\pgfmathprintnumber[precision=1]{\anglezVal}^\circ$};

  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pZero) {};
  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pOne) {};
  \node[circle, draw=red, inner sep=0pt, minimum size=6pt] at (zPos) {};

  \end{axis}
  \end{tikzpicture}
\end{minipage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\choice \begin{minipage}{0.5\linewidth}
  \pgfmathsetmacro{\angleSum}{\angleZero+\angleOne+\anglezVal}
  \begin{equation*}
  \sum\theta =
  \pgfmathprintnumber[precision=1]{\angleZero}^\circ
  +\pgfmathprintnumber[precision=1]{\angleOne}^\circ
  +\pgfmathprintnumber[precision=1]{\anglezVal}^\circ
  =\ifprintanswers
  \pgfmathprintnumber[precision=1]{\angleSum}^\circ 
  \fi
  \end{equation*}
  \centering
  \begin{tikzpicture}
  \begin{axis}[
    no marks,line width=1.4pt,
    axis equal,
    grid=both,
    xlabel={$\Re$},
    ylabel={$\Im$},
    xmin=-20,xmax=0,ymin=-1,ymax=10,
    xticklabel style={
      /pgf/number format/fixed,
      /pgf/number format/precision=1,
      rotate=90,
      anchor=near xticklabel
    },
    yticklabel style={
        /pgf/number format/fixed,
        /pgf/number format/precision=1
    },
      xtick={-\zVal,-\sigmad,-\pOne,-\pZero,0}, 
      ytick={0, \omegad},
    ]
  \coordinate (origin) at (0,0);
  \coordinate (pZero) at (-\pZero,0);
  \coordinate (pOne) at (-\pOne,0);
  \coordinate (zPos) at (-\zVal,0);
  \coordinate (desired) at (-\sigmad,\omegad);
  \coordinate (leftPoint) at (-21,0);
  \coordinate (rightPoint) at (15,0);

  \draw[gray] (-20,0) -- (20,0);
  \draw[gray] (0,-20) -- (0,20);
  \filldraw[black] (origin) circle (3pt);
  \filldraw[red] (desired) circle (3pt);

  \draw[gray] (pZero) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pZero--desired};

  \draw[gray] (pOne) -- (desired);
  \pic[draw,thick,angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = origin--pOne--desired};

  \draw[gray] (zPos) -- (desired);
  \pic[draw,thick, angle eccentricity=-4,angle radius=0.3cm 
  ]{angle = rightPoint--zPos--desired};


  \node[above] at ($(pZero) + (-20.5,-3)$) {$\pgfmathprintnumber[precision=1]{\angleZero}^\circ$};
  \node[above] at ($(pOne) + (-21,-3)$) {$\pgfmathprintnumber[precision=1]{\angleOne}^\circ$};
  \node[above] at ($(zPos) + (-19,-3)$) {$\pgfmathprintnumber[precision=1]{\anglezVal}^\circ$};

  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pZero) {};
  \node[cross out, draw=black, inner sep=0pt, minimum size=6pt] at (pOne) {};
  \node[circle, draw=red, inner sep=0pt, minimum size=6pt] at (zPos) {};

  \end{axis}
  \end{tikzpicture}
\end{minipage}

\end{randomizechoices}
