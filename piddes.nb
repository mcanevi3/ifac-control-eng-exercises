(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7740,        233]
NotebookOptionsPosition[      7228,        215]
NotebookOutlinePosition[      7655,        232]
CellTagsIndexPosition[      7612,        229]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Clear", " ", "symbols"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "p0m", ",", "p0p", ",", "p1m", ",", "p1p", ",", "kp", ",", "ki"}], "]"}],
     ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "first", " ", "column", " ", "entries", " ", "for", " ", 
     "quartic", " ", "polynomial"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"firstColumn", "[", 
      RowBox[{"p0_", ",", "p1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b1", ",", "c1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"b1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "p1"}], "-", "p0", "-", "kp"}], ")"}], "/", 
          "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "*", "p1"}], "-", "p0", "-", "kp"}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"p0", "+", "kp"}], ")"}]}], "-", 
            RowBox[{"4", "*", "ki"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "p1"}], "-", "p0", "-", "kp"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "b1", ",", "c1", ",", "ki"}], "}"}]}]}], 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Generate", " ", "the", " ", "four", " ", 
     RowBox[{"(", 
      RowBox[{"p0", ",", "p1"}], ")"}], " ", "combinations"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cols", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"firstColumn", "[", 
        RowBox[{"p0m", ",", "p1m"}], "]"}], ",", 
       RowBox[{"firstColumn", "[", 
        RowBox[{"p0p", ",", "p1m"}], "]"}], ",", 
       RowBox[{"firstColumn", "[", 
        RowBox[{"p0m", ",", "p1p"}], "]"}], ",", 
       RowBox[{"firstColumn", "[", 
        RowBox[{"p0p", ",", "p1p"}], "]"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Positivity", " ", "conditions", " ", "for", " ", "each", " ", "column", 
     " ", 
     RowBox[{"(", 
      RowBox[{"stability", " ", "requirement"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conds", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"#", ">", "0"}], "]"}], "&"}], ",", "cols"}], "]"}]}], ";"}],
    "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Add", " ", "ordering", " ", "constraints"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ordering", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p0m", "<", "p0p"}], ",", 
       RowBox[{"p1m", "<", "p1p"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Combine", " ", "all", " ", "via", " ", "logical", " ", "intersection"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"stabRegion", "=", 
     RowBox[{
      RowBox[{"Reduce", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Flatten", "[", "conds", "]"}]}], "&&", 
         RowBox[{"And", "@@", "ordering"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
         "kp", ",", "ki", ",", "p0m", ",", "p0p", ",", "p1m", ",", "p1p"}], 
         "}"}], ",", "Reals"}], "]"}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"stabRegion", "//", "FullSimplify"}], "\n", "\n", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9695308445274973`*^9, 3.9695308459607077`*^9}, {
   3.969530981059043*^9, 3.9695310963279657`*^9}, 3.969531371853505*^9, 
   3.969531747037334*^9, {3.9695320690802107`*^9, 3.969532072084363*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"58ba6369-7591-4b8f-80f1-6aabc9004410"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ki", ">", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"kp", "+", "p0p", "+", 
        FractionBox[
         RowBox[{"4", " ", "ki"}], 
         RowBox[{"kp", "+", "p0p"}]]}], "<", 
       RowBox[{"2", " ", "p1m"}]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p1m", "<", "p1p"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"2", " ", 
                SqrtBox["ki"]}], "\[Equal]", 
               RowBox[{"kp", "+", "p0m"}]}], "&&", 
              RowBox[{
               RowBox[{"kp", "+", "p0p"}], ">", 
               FractionBox[
                RowBox[{"4", " ", "ki"}], 
                RowBox[{"kp", "+", "p0m"}]]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"2", " ", 
                SqrtBox["ki"]}], "<", 
               RowBox[{"kp", "+", "p0m"}]}], "&&", 
              RowBox[{"p0m", "<", "p0p"}]}], ")"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", 
            SqrtBox["ki"]}], ">", 
           RowBox[{"kp", "+", "p0m"}]}], "&&", 
          RowBox[{
           RowBox[{"kp", "+", "p0m"}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"kp", "+", "p0p"}], ">", 
           FractionBox[
            RowBox[{"4", " ", "ki"}], 
            RowBox[{"kp", "+", "p0m"}]]}], "&&", 
          RowBox[{"p1p", ">", "p1m"}]}], ")"}]}], ")"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p0m", "<", "p0p"}], "&&", 
      RowBox[{
       RowBox[{"kp", "+", "p0m", "+", 
        FractionBox[
         RowBox[{"4", " ", "ki"}], 
         RowBox[{"kp", "+", "p0m"}]]}], "<", 
       RowBox[{"2", " ", "p1m"}]}], "&&", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["ki"]}], ">", 
       RowBox[{"kp", "+", "p0m"}]}], "&&", 
      RowBox[{
       RowBox[{"kp", "+", "p0m"}], ">", "0"}], "&&", 
      RowBox[{
       RowBox[{"kp", "+", "p0p"}], "\[LessEqual]", 
       FractionBox[
        RowBox[{"4", " ", "ki"}], 
        RowBox[{"kp", "+", "p0m"}]]}], "&&", 
      RowBox[{"p1p", ">", "p1m"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.969531062630496*^9, 3.969531373163701*^9, 
  3.969531751778573*^9, 3.9695320736364517`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"a7570618-b335-49fe-9e60-0ab1d80042c2"]
}, Open  ]]
},
WindowSize->{1858, 959},
WindowMargins->{{Automatic, 21}, {Automatic, 0}},
Magnification:>3. Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"ReverseColor.nb",
ExpressionUUID->"1cae32c4-9410-46d6-a6b5-5883effdd017"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4079, 113, 1735, "Input",ExpressionUUID->"58ba6369-7591-4b8f-80f1-6aabc9004410"],
Cell[4662, 137, 2550, 75, 701, "Output",ExpressionUUID->"a7570618-b335-49fe-9e60-0ab1d80042c2"]
}, Open  ]]
}
]
*)

